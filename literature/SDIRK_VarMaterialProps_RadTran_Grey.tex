\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}

\usepackage{graphicx} 

\usepackage{multirow}

\usepackage{rotating}

\newcommand{\fig}[1]{Fig.~\ref{#1}}                      % figure
\newcommand{\tbl}[1]{Table~\ref{#1}}                     % table

\newcommand{\benum}{\begin{equation}}
\newcommand{\eenum}{\end{equation}}

\newcommand{\be}{\begin{equation*}}
\newcommand{\ee}{\end{equation*}}

\newcommand{\bea}{\begin{eqnarray*}}
\newcommand{\eea}{\end{eqnarray*}}

\newcommand{\beanum}{\begin{eqnarray}}
\newcommand{\eeanum}{\end{eqnarray}}

\newcommand{\eqt}[1]{Eq. (\ref{#1})}
\newcommand{\eqts}[1]{Eqs. (\ref{#1})}
\newcommand{\omg}{\ensuremath{ \vec{\Omega}}}
\newcommand{\del}{\ensuremath{ \vec{\nabla} }}
\newcommand{\vect}[1]{\ensuremath{ \vec{\mathbf #1}}}


\newcommand{\B}[1]{\ensuremath{\mathbf{B_{#1} }}}
\newcommand{\J}{\ensuremath{\mathbf{J} }}
\newcommand{\p}{\ensuremath{ \partial}}
\newcommand{\M}{\ensuremath{ \mathbf M}}
\newcommand{\Mw}{\ensuremath{\widehat{\mathbf M}}}

\newcommand{\abs}[1]{\ensuremath{\left\lvert #1 \right\rvert}}
\newcommand{\norm}[1]{\ensuremath{\left\lVert #1 \right\rVert}}

%newcommand{\eqts}[1]{Eq. \reference{1}

\begin{document}

%------------------------------------------------
\author{Peter Maginot}
\date{\today}
\title{SDIRK Time Integration and Variable Material Properties for Radiative Transfer}
\maketitle
%------------------------------------------------
\section{Generic SDIRK}
Consider a generic Butcher Tableaux:
\be
\begin{array}{c|c|cccc}
\text{Stage}& c_i 	 & a  			&  		&					&	\\
\hline
1						&  c_1   &  \gamma 	&  0  	&		\dots		&  0 \\
2						&  c_2   &  a_{21}  & \gamma  & 		0		& \vdots	\\	
i						& c_i    &   a_{i1} &  a_{i2} & \ddots   &	0	\\
s      			&  c_s   &   a_{c1} & a_{c2} 	& \dots 		& \gamma \\
\hline
{}					&				&		b_1		&		b_2			& \dots 	&   b_s
\end{array}
\ee
Let $\psi$ be our variable of interest.  Then $\psi_{n+1}=\psi(t_n + \Delta t)$ is:
\benum
\psi_{n+1} = \psi_n + \Delta t \sum_{i=1}^s{b_i k_i}
\label{eq:p1}
\eenum
where $k_i$ is defined as:
\be
k_i = f\left( t_n + c_i \Delta t ~,~\psi_{n} + \Delta t \sum_{j=1}^i{c_{ij} k_j }\right)
\ee
and
\be
f(t,\psi) = \frac{\p \psi}{\p t}
\ee
\eqt{eq:p1} can also be interpreted as meaning:
\benum
\psi_i = \psi_{n} + \Delta t \sum_{j=1}^i{a_{ij} f\left(t_n + \Delta t c_j , \psi_j\right)}
\label{eq:psi-def}
\eenum

\section{Grey Equations}
We know that the 1D, mono-energetic (grey) radiative transfer equations are:
\be
\frac{1}{c}\frac{\p I}{\p t} + \mu \frac{\p }{\p x}I + \sigma_{t} I = \frac{\sigma_{s}}{4\pi}\phi + \frac{\sigma_{a}}{4\pi} acT^4 + S_I
\ee
\be
C_v\frac{\p T}{\p t} = \sigma_a\left(\phi - acT^4\right) + S_T
\ee
The driving sources are:
\be
\frac{1}{c}\frac{\p I}{\p t} + \mu \frac{\p }{\p x}I + \sigma_{t} I - \frac{\sigma_{s}}{4\pi}\phi - \frac{\sigma_{a}}{4\pi} acT^4 = S_I
\ee
\be
C_v\frac{\p T}{\p t} - \sigma_a\left(\phi - acT^4\right) = S_T
\ee
Solving for the time derivatives:
\be
\frac{\p I}{\p t} = c\left[  \frac{\sigma_s}{4\pi}\phi + \frac{\sigma_a}{4\pi} acT^4 - \mu \frac{\p I}{\p x}- \sigma_t I + S_I \right] 
\ee
\be
\frac{\p T}{\p t} = \frac{1}{C_v}\left[ \sigma_a\left(\phi - acT^4\right) + S_T\right]
\ee
Before going any further, we spatially discretize our equations, expanding in an arbitrary order Lagrangian basis.  First, transforming to a generic reference element:
\bea
x &=& x_i + \frac{\Delta x_i}{2} s \\
s &\in& [-1,1] \\
\Delta x_i &=& x_{i+1/2} - x_{i-1/2} \\
x_i &=& \frac{x_{i+1/2} + x_{i-1/2}}{2}
\eea
For generality, let $\widetilde{x}$ and $\widetilde{y}$ be unknowns represented using our finite element representation:
\be
\widetilde{x}(s) = \vect{B}(s)\cdot\vect{x} = \B{1}(s)x_1 + \B{2}x_2+ \dots + \B{N}x_N 
\ee
where
\be
\vect{B} = \left[
\begin{array}{c}
\B{1} \\
\B{2} \\
\vdots \\
\B{N}
\end{array}
\right]
\ee
and
\be
\B{i} = \frac{\prod_{k\neq i}{(x_k - x)}}{\prod_{k\neq i}(x_k - x_i)}
\ee
Further suppose we wish to take an integral of the form:
\be
\int_{-1}^1{ \vect{B} \widetilde{x}\Delta x_i ds}
\ee 
we represent this result as 
\be
{\mathbf M}\vect{x}
\ee
where
\be
\mathbf{M}_{ij} = \frac{\Delta x_i}{2}\int_{-1}^1{\B{i}(s) \B{j}(s) ds} \approx \frac{\Delta x_i}{2}\sum_{q=1}^{N_q}{w_q \B{i}(s)\bigg \lvert_{s=s_q} \B{j}(s) \bigg \lvert_{s=s_q} }
\ee
Similarly if we want to calculate the integral:
\be
\int_{-1}^1{ \vect{B} \widetilde{x} \widetilde{y}  \Delta x_i ds}
\ee
we will denote this result as:
\be
\widehat{\mathbf M}_{x} \vect{y}
\ee
where
\be
\Mw_{x,ij} = \frac{\Delta x_i}{2}\int_{-1}^1{ x(s) \B{i}(s) \B{j}(s) ds} \approx 
\frac{\Delta x_i}{2}\sum_{q=1}^{N_q}{ \left\{ 
w_q \B{i}\bigg\lvert_{s=s_q} \B{j}\bigg\lvert_{s=s_q} \left[\vect{x} \cdot \vect{\B{} }(s) \bigg \lvert_{s=s_q}  \right] 
\right \} 
}
\ee
%Similarly if we want to calculate the integral:
%\be
%\int_{0}^1{ \vect{B} \widetilde{x} \widetilde{y} \widetilde{z} \Delta x_i ds}
%\ee
%we will denote this result as:
%\be
%\widehat{\mathbf M}_{xy[z]} \vect{z}
%\ee
Our fundamental unknowns will be expressed as:
\bea
I(s) &=& \vect{B}(s) \cdot \vect{I} \\
T(s) &=& \vect{B}(s) \cdot \vect{T}
\eea
where:
\bea
\vect{T} &=&\left[\begin{array}{c}
T_1 \\
T_2 \\
\vdots \\
T_N
\end{array}
\right] \\
\vect{ I} &=&\left[\begin{array}{c}
I_{1} \\
I_{2} \\
\vdots \\
I_{N}
\end{array}
\right] \\
\eea
Material properties will be interpolated in space from their values at the finite element interpolation points.  For example:
\bea
\frac{\sigma_a}{C_v}(s) &=& \sum_{j=1}^N{\B{j}(s) \frac{\sigma_a}{C_v}\bigg \rvert_{T = T_j} } = \vect{B} \cdot \vect{ {\frac{\sigma_a}{C_v}} } \\
\sigma_t(s) &=& \sum_{j=1}^N{ \sigma_t(T_j) \B{j}(s)} = \vect{B} \cdot \vect{\sigma}_t \\
\eea
The Planck function, $B(T)$ will be similarly expanded:
\be
B(s) = \vect{B}(s) \cdot \widehat{\mathbf B} \\   
\ee
where for the grey case:
\be
\widehat{\mathbf B} = \frac{1}{4\pi}\left[
\begin{array}{c}
acT_1^4 \\
\vdots \\
acT_j^4 \\
\vdots \\
acT_N^4 \\
\end{array}
\right] \\
\ee
Since the Planck function is a highly nonlinear function of $T$, we elect to linearize it about an arbitrary temperature, $T^*$:
\be
B(T) \approx B(T^*) + \frac{\p }{\p T}\left[B(T^*)\right](T-T^*)
\ee
for the grey case:
\be
acT^4\approx \left[ac(T^*)^4 +  4ac(T^*)^3 (T - T^*)\right]
\ee
Expressing in vector/matrix form:
\benum
\widehat{\mathbf B} =  \vect{B}^* + \widehat{\mathbf D}^*\left(\vect{T} - \vect{T^*}  \right)
\label{eq:bg-vect}
\eenum
where:
\be
\vect{B}^* = \left[\begin{array}{c}
\vdots \\
 B(T_j^*) \\
 \vdots
 \end{array}
  \right]
\ee
and $\widehat{\mathbf D}^*$ is a $N\times N$ diagonal matrix with non zero elements, $d_{jj}$:
\be
d_{jj} = \frac{\p B}{\p T} \bigg |_{T=T_j^*}
\ee
Since the sources are slightly prickly, that is we don't necessarily want to express $S_I$ and $S_T$ as polynomials in the basis functions, we definte the following vectors:
\bea
\vec{S}_{I,j} &=& \int_{-1}^1{\B{j} S_I(s)~ds} \\
\vec{S}_{T,j} &=& \int_{-1}^1{\B{j} S_T(s)~ds}
\eea

Having defined all this notation, we give the spatially discretized equations for cell $i$:
\benum
\frac{\p }{\p t}\left[\mathbf{M} \vect{I}  \right] = c\left[
\frac{1}{4\pi}\widehat{ \mathbf M}_{\sigma_s}\vect{\phi} + \widehat{\mathbf M}_{\sigma_a}\left(\vect{B}^* + \widehat{\mathbf D}^*\left(\vect{T} -\vect{T}^*  \right)   \right)- \widehat{\mathbf M}_{\sigma_t} \vect{I} - \widehat{ \mathbf L}\vect{I} + \vec{S}_I
\right]
\label{eq:disc-intensity}
\eenum
\benum
\frac{\p }{\p t}\left[\Mw_{C_v^*}\vect{T}   \right] = 
\Mw_{\sigma_a} \left(\vect{\phi} -4\pi\vect{B}^* - 4\pi\mathbf{D}^*\left( \vect{T} - \vect{T}^* \right)\right) + \vec{S}_T
\label{eq:disc-temperature}
\eenum
where $\widehat{ \mathbf L}\vect{I}$ is defined as:
\beanum
\widehat{\mathbf L}\vect{I} &=& \mathbf{L}\vect{I} + \vect{L}I_{in} + \hat{\mathbf L}\vect{I}\\
%
%
%
\mathbf{L}_{ij} &=& -\mu \int_{-1}^{1}{\frac{\p B_i(s)}{\p s}B_j(s) ds} \\
%
%
%
\vect{L}_i &=& \left \{
\begin{array}{cc}
\text{if }\mu>0  ~&~~~~ \vect{L}_i = -\mu \B{i}(-1) \\
~ & ~ \\
\text{else }     ~& \vect{L}_i = \mu \B{i}(1) \\
\end{array}
\right . \\
%
%
%
\hat{\mathbf L}_{ij} &=& \left \{
\begin{array}{cc}
\text{if }\mu>0  ~&~\hat{\mathbf L}_{ij} = \mu \B{i}(1) \B{j}(1) \\
~ & ~ \\
\text{else }     ~&~~~~~ \hat{\mathbf L}_{ij} = -\mu \B{i}(-1) \B{j}(-1) \\
\end{array}
\right . \\
\label{eq:divergence-op}
\eeanum
Solving for $k_I$ and $k_T$ we have:
\benum
k_I = c\M^{-1}\left[   
\frac{1}{4\pi}\Mw_{\sigma_s}\vect{\phi} + \Mw_{\sigma_a}\left(\vect{B}^* + \widehat{\mathbf D}^*\left(\vect{T} -\vect{T}^*  \right)   \right)- \widehat{\mathbf M}_{\sigma_t} \vect{I} - \widehat{ \mathbf L}\vect{I} + \vec{S}_I
\right]
\label{eq:kI}
\eenum
\benum
k_T = \Mw_{C_v}^{-1}\left[
\Mw_{\sigma_a} \left(\vect{\phi} - 4\pi\vect{B}^* - 4\pi\mathbf{D}^*\left( \vect{T} - \vect{T}^* \right)\right) + \vec{S}_T
\right]
\label{eq:kT}
\eenum

\subsection{First RK step}
We know look at \eqt{eq:psi-def} for step 1 of an arbitrary, diagonally implicit RK scheme:
\benum
\vect{I}_1 = \vect{I}_n + c\Delta t a_{11}\mathbf{M}^{-1}\left[   
\frac{1}{4\pi}\widehat{ \mathbf M}_{\sigma_s,*}\vect{\phi}_1 + \widehat{\mathbf M}_{\sigma_a,*}\left(\vect{B}^* + \widehat{\mathbf D}^*\left(\vect{T}_1 -\vect{T}^*  \right)   \right)- \widehat{\mathbf M}_{\sigma_t,*} \vect{I}_1 - \widehat{ \mathbf L}\vect{I}_1 
+ \vec{S}_I
\right]
\label{eq:first_I}
\eenum
\benum
\vect{T}_1  = \vect{T}_n + \Delta t a_{11} \Mw_{C_v}^{-1}\left[
\Mw_{\sigma_a} \left(\vect{\phi}_1 - 4\pi\vect{B}^* - 4\pi\mathbf{D}^*\left( \vect{T}_1 - \vect{T}^* \right)\right) + \vec{S}_T
\right]
\label{eq:first_T}
\eenum
We now use \eqt{eq:first_T} to eliminate the unknown temperature, $\vect{T}_1$ from \eqt{eq:first_I}. Solving \eqt{eq:first_T} for $\vect{T}_1$:
\be
\vect{T}_1 +  4\pi\Delta t a_{11} \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^* \vect{T}_1   = \vect{T}_n + \Delta t a_{11} \Mw_{C_v}^{-1}\left[
\Mw_{\sigma_a*} \left(\vect{\phi}_1 -  4\pi\vect{B}^*+ 4\pi\mathbf{D}^*\vect{T}^* \right) + \vec{S}_T
\right]
\ee
\begin{multline*}
\vect{T}_1 = \left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*   \right]^{-1}
\left[
\vect{T}_n + \Delta t a_{11}  \Mw_{C_v}^{-1}\left[ \Mw_{\sigma_a} \left(\vect{\phi}_1 -4\pi \vect{B}^*+ 4\pi\mathbf{D}^*\vect{T}^* \right) +  \vec{S}_T \right]  
\right] \dots \\ + \left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*   \right]^{-1}\left[\vect{T}^* - \vect{T}^*  \right]
\end{multline*}
%
%
\begin{multline*}
\vect{T}_1 = \left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*   \right]^{-1}
\left[
\vect{T}_n + \Delta t a_{11}  \Mw_{C_v}^{-1}\left[ \Mw_{\sigma_a*} \left(\vect{\phi}_1 - 4\pi\vect{B}^*  \right)+ \vec{S}_T \right]\right] \dots \\ 
+ 
\left[\mathbf{I} +  4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*  \right]^{-1}
\left[\mathbf{I} +  4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*   \right] \vect{T}^* \dots \\
- \left[\mathbf{I} +  4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*   \right]^{-1}\vect{T}^*
\end{multline*}
%
%finished the above
%
%
%
\benum
\vect{T}_1 = \vect{T}^* + \left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^* \right]^{-1}\left[\vect{T}_n - \vect{T}^* +  \Delta t a_{11}  \Mw_{C_v}^{-1}\left[ \Mw_{\sigma_a*} \left(\vect{\phi}_1 - 4\pi\vect{B}^*\right) + \vec{S}_{T}\right]\right]
\label{eq:iso_T1}
\eenum
%
%
Inserting \eqt{eq:iso_T1} into \eqt{eq:first_I}:
\begin{multline*}
\vect{I}_1 = \vect{I}_n + c\Delta t a_{11}\mathbf{M}^{-1}\left[   
\frac{1}{4\pi}\widehat{ \mathbf M}_{\sigma_s,*}\vect{\phi}_1 + \widehat{\mathbf M}_{\sigma_a,*}\vect{B}^* - \widehat{\mathbf M}_{\sigma_t,*} \vect{I}_1 - \widehat{ \mathbf L}\vect{I}_1  + \vec{S}_I \right] \dots  \\
+ c \Delta t a_{11}\M^{-1} \Mw_{\sigma_a,*}\widehat{\mathbf D}^* 
\left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*   \right]^{-1}
\left[\vect{T}_n - \vect{T}^* +  \Delta t a_{11} \Mw_{C_v}^{-1}\left[ \Mw_{\sigma_a*} \left(\vect{\phi}_1 - 4\pi\vect{B}^*\right) + \vec{S}_T \right]\right] 
\end{multline*}
%
%
%
Multiply by $\frac{1}{c\Delta t a_{11}}\mathbf{M}$
\begin{multline*}
\frac{1}{c\Delta t a_{11}}\M\vect{I}_1 = \frac{1}{c\Delta t a_{11}}\M\vect{I}_n + \left[   
\frac{1}{4\pi}\Mw_{\sigma_s,*}\vect{\phi}_1 + \Mw_{\sigma_a,*}\vect{B}^* - \Mw_{\sigma_t,*} \vect{I}_1 - \widehat{ \mathbf L}\vect{I}_1  + \vec{S}_I \right] \dots  \\
+ \Mw_{\sigma_a,*}
\widehat{\mathbf D}^* 
\left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*   \right]^{-1}
\left[\vect{T}_n - \vect{T}^* +  \Delta t a_{11} \Mw_{C_v}^{-1}\left[ \Mw_{\sigma_a*} \left(\vect{\phi}_1 - 4\pi\vect{B}^*\right) + \vec{S}_T\right]\right] 
\end{multline*}
%
%
%
and move some terms over to the LHS:
\begin{multline*}
\widehat{ \mathbf L}\vect{I}_1 + \left(\frac{1}{c\Delta t a_{11}} \M + \Mw_{\sigma_t,*} \right)\vect{I}_1 = \frac{1}{c\Delta t a_{11}}\mathbf{M}\vect{I}_n +   
\frac{1}{4\pi}\Mw_{\sigma_s,*}\vect{\phi}_1 + \Mw_{\sigma_a,*}\vect{B}^* + \vec{S}_I \dots  \\
+ \Mw_{\sigma_a,*} \widehat{\mathbf D}^* \left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*   \right]^{-1}
\left[\vect{T}_n - \vect{T}^* +  \Delta t a_{11}  \Mw_{C_v}^{-1}\left[ \Mw_{\sigma_a*} \left(\vect{\phi}_1 - 4\pi\vect{B}^*\right) + \vec{S}_T\right]\right] 
\end{multline*}
%
%above here
%
Further manipulating to pull all of the $\vect{\phi}_1$ terms together:
%
%
\begin{multline}
\widehat{ \mathbf L}\vect{I}_1 + \left(\frac{1}{c\Delta t a_{11}} \M + \Mw_{\sigma_t,*} \right)\vect{I}_1 = \dots \\
\frac{1}{4\pi}\Mw_{\sigma_s,*}\vect{\phi}_1 + \Delta t a_{11} \Mw_{\sigma_a,*} \widehat{\mathbf D}^* 
\left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a*} \mathbf{D}^*   \right]^{-1}
  \Mw_{C_v}^{-1}\Mw_{\sigma_a*}
\vect{\phi}_1 \dots \\
+ \frac{1}{c\Delta t a_{11}}\mathbf{M}\vect{I}_n +\widehat{\mathbf M}_{\sigma_a,*}\vect{B}^* + \vec{S}_I  \dots \\
+ \Mw_{\sigma_a,*} \widehat{\mathbf D}^*
\left[\mathbf{I} +4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a*} \mathbf{D}^*   \right]^{-1}
\left[\vect{T}_n - \vect{T}^* + \Delta t a_{11}  \Mw_{C_v}^{-1}\left[ \vec{S}_T -4\pi\Mw_{\sigma_a*} \vect{B}^*\right] \right] 
\label{eq:almost_1}
\end{multline}
Though it does not look that familiar, \eqt{eq:almost_1} can be made to resemble the canonical mono-energetic neutron fission equation.  Let us define the following terms:
\begin{subequations}
\label{eq:step1_defs}
\benum
\bar{\bar{\mathbf \nu}} = 4\pi\Delta t a_{11} \widehat{\mathbf M}_{\sigma_a,*}
\widehat{\mathbf D}^* \left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*   \right]^{-1}\Mw_{C_v}^{-1}
\eenum
 %
 %
 \begin{multline}
\bar{\bar{\mathbf \xi}}_d = \frac{1}{c\Delta t a_{11}}\mathbf{M}\vect{I}_n + \Mw_{\sigma_a,*}\vect{B}^*  + \vec{S}_I \dots \\ 
+ \widehat{\mathbf M}_{\sigma_a,*}
\widehat{\mathbf D}^* 
\left[\mathbf{I} + 4\pi\Delta t a_{11}  \Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*   \right]^{-1}
\left[\vect{T}_n - \vect{T}^* + \Delta t a_{11}  \Mw_{C_v}^{-1}\left[\vec{S}_T - 4\pi\Mw_{\sigma_a}\vect{B}^*\right]\right] 
\end{multline}
%
\benum
\bar{\bar{\mathbf M}}_{\sigma_t} = \frac{1}{c\Delta t a_{11}} \mathbf{M} + \widehat{\mathbf M}_{\sigma_t,*}
\eenum
\end{subequations}
Inserting \eqts{eq:step1_defs} into \eqt{eq:almost_1} gives our final form:
\benum
\widehat{ \mathbf L}\vect{I}_1 + \bar{\bar{\mathbf M}}_{\sigma_t}\vect{I}_1 = \frac{1}{4\pi}\widehat{\mathbf M}_{\sigma_s,*}\vect{\phi}_1 + \frac{1}{4\pi}\bar{\bar{\mathbf \nu}}\widehat{\mathbf M}_{\sigma_a*} \vect{\phi}_1 +  \bar{\bar{\mathbf \xi}}_d
\label{eq:1_done}
\eenum
Having found $\vect{I}_1$ by solving \eqt{eq:1_done}, we use \eqt{eq:iso_T1} to find $\vect{T}_1$.  There are two options to proceed at this point
\begin{enumerate}
\item use the new value of $\vect{T}_1$ as the next iterate for $\vect{T}_*$ or
\item do not iterate on $\vect{T}_*$, and proceed with the calculation
\end{enumerate}
Having found $\vect{T}_1$, either by iterating or solving once, the values of $k_{I,1}$ and $k_{T,1}$ are found by applying the definitions of \eqt{eq:kI} and \eqt{eq:kT} respectively (noting that since we now know $\vect{T}_1$, we also know $\widehat{\mathbf B}_1$, and do not need to linearize)
\be
k_{I,1} = c\mathbf{M}^{-1}\left[   
\frac{1}{4\pi}\widehat{ \mathbf M}_{\sigma_{s},1}\vect{\phi}_1 + \widehat{\mathbf M}_{\sigma_{a},1}\widehat{\mathbf B}_1 - \widehat{\mathbf M}_{\sigma_{t},1} \vect{I}_1 - \widehat{ \mathbf L}\vect{I}_1 + \vec{S}_I
\right]
\ee
\be
k_{T,1} = \Mw_{C_v}^{-1} \left[  \Mw_{\sigma_a} \left(\vect{\phi}_1 - 4\pi\widehat{\mathbf B}_1\right) + \vec{S}_T \right]
\ee
%
%
%
%
\subsection{$i$-th RK step}
Moving on to the $i$-th RK step, we first write the equation for $\vect{I}_i$ and $\vect{T}_{i}$:
\benum
\vect{I}_i = \vect{I}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } + \Delta t a_{ii} c \mathbf{M}^{-1}\left[
\frac{1}{4\pi}\widehat{ \mathbf M}_{\sigma_s,*}\vect{\phi}_i +
\Mw_{\sigma_a,*}\left(\vect{B}^* + \widehat{\mathbf D}^*\left(\vect{T}_i -\vect{T}^*  \right)   \right)- \widehat{\mathbf M}_{\sigma_t,*} \vect{I}_i - \widehat{ \mathbf L}\vect{I}_i + \vec{S}_I
\right]
\label{eq:first_kIi}
\eenum
\benum
\vect{T}_i = \vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   } + \Delta t a_{ii}\Mw_{C_v}^{-1}\left[
\Mw_{\sigma_a*}\left(\vect{\phi}_i - 4\pi\vect{B}^* - 4\pi\mathbf{D}^*\left( \vect{T}_i - \vect{T}^* \right)\right) + \vec{S}_T 
\right]
\label{eq:first_kTi}
\eenum
%
%
Proceeding in a similar fashion as before, we solve \eqt{eq:first_kTi} for $\vect{T}_{i}$.
%
%
\be
\vect{T}_i +4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*\vect{T}_i = \vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   } + \Delta t a_{ii}
\Mw_{C_v}^{-1}\left[
\Mw_{\sigma_a*} \left(\vect{\phi}_i - 4\pi\vect{B}^* + 4\pi\mathbf{D}^*\vect{T}^* \right) + \vec{S}_T
 \right]
\ee
%
%
\be
\left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a}\mathbf{D}^*  \right]\vect{T}_i = \vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   } + \Delta t a_{ii}\Mw_{C_v}^{-1}\left[\Mw_{\sigma_a*} \left(\vect{\phi}_i - 4\pi\vect{B}^* + 4\pi\mathbf{D}^*\vect{T}^* \right) + \vec{S}_T \right]
\ee
%
%
%Stopped here
%
%%
\begin{multline*}
\vect{T}_i = \left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\left[\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\mathbf{I} +  4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\Mw_{C_v}^{-1}\left[
\Mw_{\sigma_a*} \left(\vect{\phi}_i - 4\pi\vect{B}^* + 4\pi\mathbf{D}^*\vect{T}^* \right) + \vec{S}_T 
\right] 
\end{multline*}
%
%
%stopped above
%
%\begin{multline*}
%\vect{T}_i = \left[\mathbf{I} + \Delta t a_{ii}\widehat{\mathbf M}_{C_v,*}^{-1}\widehat{\mathbf M}_{\sigma_a,*}\mathbf{D}^*  \right]^{-1}\left[\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
%+ \Delta t a_{ii}\left[\mathbf{I} + \Delta t a_{ii}\widehat{\mathbf M}_{C_v,*}^{-1}\widehat{\mathbf M}_{\sigma_a,*}\mathbf{D}^*  \right]^{-1}
%\widehat{\mathbf M}_{C_v,*}^{-1}\widehat{\mathbf M}_{\sigma_a,*} \left(\vect{\phi}_i - \vect{B}^* + \mathbf{D}^*\vect{T}^* \right) \dots \\
%+ \left[\mathbf{I} + \Delta t a_{ii}\widehat{\mathbf M}_{C_v,*}^{-1}\widehat{\mathbf M}_{\sigma_a,*}\mathbf{D}^*  \right]^{-1} \mathbf{I} \left(\vect{T}^* - \vect{T}^*  \right)
%\end{multline*}
%
%
%below this
%
\begin{multline*}
\vect{T}_i = \left[\mathbf{I} +4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\left[\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\mathbf{I} +4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}
\Mw_{C_v}^{-1}\left[ \Mw_{\sigma_a*}\left(\vect{\phi}_i - 4\pi\vect{B}^*\right)  + \vec{S}_T \right]\dots \\
+4\pi\Delta t a_{ii}\left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}
\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*\vect{T}^*
\end{multline*}
%
%
Adding nothing:
\begin{multline*}
\vect{T}_i = \left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\left[\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}
\Mw_{C_v}^{-1}\left[\Mw_{\sigma_a*} \left(\vect{\phi}_i -  4\pi\vect{B}^*\right) + \vec{S}_T \right]\dots \\
+\left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}
\left[ 4\pi\Delta t a_{ii} \Mw_{C_v}^{-1}\Mw_{\sigma_a*}  \mathbf{D}^*\vect{T}^* \right]\dots \\
+ \left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1} \mathbf{I}\left( \vect{T}^* - \vect{T}^*\right)
\end{multline*}
%
%
simplifying
\begin{multline*}
\vect{T}_i = \left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\left[\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}
\Mw_{C_v}^{-1}\left[\Mw_{\sigma_a*}\left(\vect{\phi}_i - 4\pi\vect{B}^*\right) + \vec{S}_T \right]\dots \\
+\left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}
\left[ \mathbf{I} + 4\pi\Delta t a_{ii} \Mw_{C_v}^{-1}\Mw_{\sigma_a*} \mathbf{D}^*\right]\vect{T}^* \dots \\
- \left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1} \mathbf{I}\vect{T}^* 
\end{multline*}
%
%
%
\begin{multline}
\vect{T}_i = \vect{T}^*   + \left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\left[\vect{T}_n -\vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\Mw_{C_v}^{-1}
\left[ \Mw_{\sigma_a*}\left(\vect{\phi}_i - 4\pi\vect{B}^*  \right) + \vec{S}_T \right]
\label{eq:Ti_iso}
\end{multline}
%stopped above here
%
Multiplying \eqt{eq:first_kIi} by $\frac{1}{c\Delta t a_{ii}}\mathbf{M}$:
\begin{multline}
\frac{1}{c\Delta t a_{ii}}\mathbf{M}\vect{I}_i = \frac{1}{c\Delta t a_{ii}}\mathbf{M}\vect{I}_n + \frac{1}{c a_{ii}} \mathbf{M} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } \dots \\
+ 
\frac{1}{4\pi}\widehat{ \mathbf M}_{\sigma_s,*}\vect{\phi}_i + 
\widehat{\mathbf M}_{\sigma_a,*}\left(\vect{B}^* + \widehat{\mathbf D}^*\left(\vect{T}_i -\vect{T}^*  \right)   \right)- \widehat{\mathbf M}_{\sigma_t,*} \vect{I}_i - \widehat{ \mathbf L}\vect{I}_i  + \vec{S}_I
\label{eq:kIi_second}
\end{multline}
%
%
Inserting \eqt{eq:Ti_iso} into \eqt{eq:kIi_second}:
%
%
\begin{multline*}
\widehat{\mathbf L} \vect{I}_i + \left( \frac{1}{c\Delta t a_{ii}}\M + \Mw_{\sigma_t,*} \right) \vect{I}_i = 
\frac{1}{c\Delta t a_{ii}}\M\vect{I}_n + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } 
+ \frac{1}{4\pi}\Mw_{\sigma_s,*}\vect{\phi}_i 
+ \Mw_{\sigma_a,*}\vect{B}^* \dots \\ 
+ \Mw_{\sigma_a,*} \widehat{\mathbf D}^* \Bigg \{ 
\left[\mathbf{I} + 4\pi \Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}
\left[\vect{T}_n -\vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right]  \dots \\
+ \Delta t a_{ii}\left[\mathbf{I} + 4\pi \Delta t a_{ii}\Mw_{C_v}^{-1} \Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1} 
\Mw_{C_v}^{-1}\left[\Mw_{\sigma_a*} \left(\vect{\phi}_i - 4\pi \vect{B}^*  \right) + \vec{S}_T \right]  \Bigg \}
\end{multline*}
%
%
Re-arranging to isolate $\vect{\phi}_i$:
%
%
\begin{multline}
\widehat{\mathbf L} \vect{I}_i + \left( \frac{1}{c\Delta t a_{ii}}\M + \Mw_{\sigma_t,*} \right) \vect{I}_i =  \frac{1}{4\pi}\Mw_{\sigma_s,*}\vect{\phi}_i \dots \\
%
%
+  \Delta t a_{ii} \widehat{\mathbf M}_{\sigma_a,*} \widehat{\mathbf D}^* 
\left[\mathbf{I} + 4\pi \Delta t a_{ii}\Mw_{C_v}^{-1} \Mw_{\sigma_a,*}\mathbf{D}^*  \right]^{-1}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\vect{\phi}_i\dots \\
%
%
+ \frac{1}{c\Delta t a_{ii}}\mathbf{M}\vect{I}_n + \frac{1}{c a_{ii}} \mathbf{M} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } + \Mw_{\sigma_a,*}\vect{B}^* \dots \\
%
%
+ \widehat{\mathbf M}_{\sigma_a,*} \widehat{\mathbf D}^* 
\left[\mathbf{I} + 4\pi \Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*} \widehat{\mathbf D}^*\right]^{-1}
\left[
\vect{T}_n - \vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   +  \Delta t a_{ii} } \Mw_{C_v}^{-1}\left[\vec{S}_T - 4\pi\Mw_{\sigma_a*} \mathbf{B}^* \right]
\right]
\end{multline}
Make the following definitions:
\begin{subequations}
\label{eq:stepi_defs}
\begin{multline}
\bar{\bar{\mathbf \xi}}_{i,d}  = \frac{1}{c\Delta t a_{ii}}\mathbf{M}\vect{I}_n + \frac{1}{c a_{ii}} \mathbf{M} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } + \widehat{\mathbf M}_{\sigma_a,*}\vect{B}^* \dots \\
+ \Mw_{\sigma_a,*} \widehat{\mathbf D}^* 
\left[\mathbf{I} + 4\pi \Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*} \widehat{\mathbf D}^*\right]^{-1}
\left[
\vect{T}_n - \vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   + \Delta t a_{ii} } \Mw_{C_v}^{-1}\left[\vec{S}_T - 4\pi\Mw_{\sigma_a*} \mathbf{B}^*\right]
\right]
\end{multline}
 %
 %
\beanum
\bar{\bar{\mathbf \nu}}_i &=& 4\pi \Delta t a_{ii} \widehat{\mathbf M}_{\sigma_a,*} \widehat{\mathbf D}^* \left[\mathbf{I} + 4\pi\Delta t a_{ii}\Mw_{C_v}^{-1}\Mw_{\sigma_a*}\mathbf{D}^*  \right]^{-1}\Mw_{C_v}^{-1}
\\
\bar{\bar{\mathbf M}}_{\sigma_t,i} &=& \mathbf{M}_{\sigma_t,*} + \frac{1}{c\Delta t a_{ii}}\mathbf{M}
\eeanum
\end{subequations}
This then gives us our final equation for the radiation intensity:
\benum
\widehat{\mathbf L} \vect{I}_i + \bar{\bar{\mathbf M}}_{\sigma_t,i}\vect{I}_i = \frac{1}{4\pi}\mathbf{M}_{\sigma_s,*}\vect{\phi}_i + \frac{1}{4\pi}\bar{\bar{\mathbf \nu}}_i \widehat{\mathbf M}_{\sigma_a*}\vect{\phi}_i + \bar{\bar{\mathbf \xi}}_{i,d}
\eenum
Having found $\vect{I}$ for the $i$-th RK time step, we solve for $\vect{T}_i$ using \eqt{eq:Ti_iso}.  At this point, we again have the option to either iterate on $\vect{T}_i$, or we only solve for $\vect{T}_i$ once.  Regardless of whether we iterate for $\vect{T}_i$ or not, we evaluate all material properties at the final value of $\vect{T}_i$, and apply the definitions of $k_{T,i}$ and $k_{I,i}$:
\benum
k_{I,i} = c\mathbf{M}^{-1}\left[   
\frac{1}{4\pi}\widehat{ \mathbf M}_{\sigma_s,i}\vect{\phi}_i + \widehat{\mathbf M}_{\sigma_a,i}\widehat{\mathbf B}_i- \widehat{\mathbf M}_{\sigma_t} \vect{I}_i - \widehat{ \mathbf L}\vect{I}_i  + \vec{S}_I
\right]
\eenum
\benum
k_{T,i} = \Mw_{C_v}^{-1}\left[
\Mw_{\sigma_a,i} \left(\vect{\phi}_i - 4\pi\widehat{\mathbf B}_i \right) + \vec{S}_T
\right]
\eenum
After completing all steps of the particular RK scheme, we advance $\vect{I}_n \to \vect{I}_{n+1}$ and $\vect{T}_n \to \vect{T}_{n+1}$:
\bea
\vect{I}_{n+1} &=& \vect{I}_n + \Delta t \sum_{i=1}^s{b_i k_{I,i}} \\ 
\vect{T}_{n+1} &=& \vect{T}_n + \Delta t \sum_{i=1}^s{b_i k_{T,i}} \\ 
\eea 

%\section{Multigroup Case}
%We previously considered only the mono-energetic case.  In reality, photons are span a continuum of energies, and we really would like to solve:
%\be
%\frac{1}{c}\frac{\p I(E)}{\p t} + \mu \frac{\p I(E)}{\p x} + \sigma_t(E)I(E) = \frac{\sigma_s(E)}{4\pi}\phi(E) + \sigma_a(E) B(E,T)
%\ee
%\be
%C_v\frac{\p T}{\p t} = \int_0^{\infty}{\sigma_a(E)\left[\phi(E) - 4\pi B(E,T)\right] dE}
%\ee
%The typical discretization technique used for the energy variable is the multigroup method.  The multigroup method assumes a finite number of groups, $G$.  Ideally, we would have:
%\bea
%I_g &=& \int_{E_{min}}^{E_{max}}{I(E) dE} \\
%I_g \sigma_g &=& \int_{E_{min}}^{E_{max}}{I(E)\sigma(E)dE} \\
%\int_{0}^{\infty}{\sigma(E)I(E) dE} &=& \sum_{g=1}^G{\sigma_g I_g} 
%\eea
%where $E_{min}$ and $E_{max}$ are the minimum and maximum photon energy of each group, $g$.  In practice though we are solving an equation of the form:
%\be
%\mu \frac{\p I_g}{\p x} + \sigma_{t,g}(\phi_g) I_g = \frac{\sigma_{s,g}(\phi_g)}{4\pi}\phi_g + \sigma_{a,g}(\phi_g) B_g 
%\ee
%and this is too nonlinear to be tractable to solve.  Instead, we assume some energy spectrum a priori in order to have $\sigma_{a,g},~\sigma_{s,g}$ known beforehand.  The selection of a weighting function (Rosseland, Planck, etc.) will not be discussed further as it is not the focus of this work.  As a result, we will then have quantities of the following type:
%\bea
%I_g &=& \int_{E_{min}}^{E_{max}}{I(E) dE} \\
%\sigma_g &=& \frac{\int_{E_{min}}^{E_{max}}{w(E)\sigma(E)dE}}{\int_{E_{min}}^{E_{max}}{w(E) dE}} \\
%B_g &=& \int_{E_{min}}^{E_{max}}{ B(E,T) dE} \\
%\sigma_g I_g & \approx & \int_{E_{min}}^{E_{max}}{\sigma(E) I(E) dE} \\ 
%\sigma_g B_g & \approx & \int_{E_{min}}^{E_{max}}{\sigma(E) B(E,T) dE} 
%\eea
%The spatially and temporally analytic, multigroup equations are then:
%\benum
%\frac{1}{c}\frac{\p I_g(\mu)}{\p t} + \mu\frac{\p I_g}{\p x} + \sigma_{t,g}I_g(\mu) = \frac{\sigma_{s,g}}{4\pi} \phi_g + \sigma_{a,g} B_g
%\eenum
%\benum
%C_v \frac{\p T}{\p t} = \sum_{g=1}^G{\sigma_{a,g}\left(\phi_g - 4\pi B_g  \right)}
%\eenum
%Adjusting our Planck function expansion for multigroup use, we define:
%\be
%\widehat{\mathbf B}_g = \left[\begin{array}{c} 
%\int_{E_{min,g}}^{E_{max,g}}{B(E,T_1) dE} \\ 
%\vdots \\ 
%\int_{E_{min,g}}^{E_{max,g}}{B(E,T_i) dE} \\ 
%\vdots \\
%\int_{E_{min,g}}^{E_{max,g}}{B(E,T_N) dE}  
%\end{array}   \right]
%\ee
%%
%%
%and $\widehat{\mathbf D}_g^*$ is a diagonal matrix with non-zero main diagonal elements $d_ii$:
%\be
%d_{ii} = \int_{E_{min,g}}^{E_{max,g}}{\frac{\p B(E,T)}{\p T}\bigg |_{T=T_N} dE}  
%\ee
%giving our familiar linearization:
%\be
%\widehat{\mathbf B}_g \approx \widehat{\mathbf B}_g^* + \widehat{\mathbf D}_g^* \left(\vect{T} - \vect{T}^*  \right)
%\ee
%with this notation, our spatially discretized, temporally analytic equations are:
%\benum
%\frac{1}{c}\frac{\p}{\p t}\mathbf{M} \vect{I}_{d,g} + \widehat{\mathbf{L}} \vect{I}_{d,g} + \Mw_{\sigma_{t,g}^*} \vect{I}_{d,g}= \frac{1}{4\pi} \Mw_{\sigma_{s,g}^*} \vect{\phi} + \Mw_{\sigma_{a,g}^*} \left[\widehat{\mathbf B}_g^* + \widehat{\mathbf D}_g^*\left(\vect{T}- \vect{T}^*  \right)  \right]
%\label{eq:multi-group-intensity}
%\eenum
%\benum
%\frac{\p}{\p t} \left[\Mw_{C_v^*} \vect{T}  \right] = \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_g - 4\pi\left[\widehat{\mathbf B}_g^* +   \widehat{\mathbf D}_g^*\left(\vect{T} - \vect{T}^*  \right)\right]   \right \} }
%\label{eq:multi-group-temperature}
%\eenum
%solving for $k_{I,g}$ and $k_{T}$ we have:
%\benum
%k_{I,g} = c\M^{-1}\left[ \frac{1}{4\pi} \Mw_{\sigma_{s,g}^*} \vect{\phi}_g + \Mw_{\sigma_{a,g}^*} \left[\widehat{\mathbf B}_g^* + \widehat{\mathbf D}_g^*\left(\vect{T}- \vect{T}^*  \right)  \right] - \widehat{\mathbf{L}} \vect{I}_{d,g} - \Mw_{\sigma_{t,g}^*} \vect{I}_{d,g}\right]
%\label{eq:kI_multi}
%\eenum
%\benum
%k_T = \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_g - 4\pi\left[\widehat{\mathbf B}_g^* +   \widehat{\mathbf D}_g^*\left(\vect{T} - \vect{T}^*  \right)\right]   \right \} } \right]
%\label{eq:kT_multi}
%\eenum
%
%\subsection{First RK step}
%The equations for the first stage of an SDIRK scheme are:
%\benum
%\vect{I}_{g,1} = \vect{I}_n + a_{11} \Delta t c\M^{-1}\left[ \frac{1}{4\pi} \Mw_{\sigma_{s,g}^*} \vect{\phi}_{g,1} + \Mw_{\sigma_{a,g}^*} \left[\widehat{\mathbf B}_g^* + \widehat{\mathbf D}_g^*\left(\vect{T}_1- \vect{T}^*  \right)  \right] - \widehat{\mathbf L} \vect{I}_{d,g,1} - \Mw_{\sigma_{t,g}^*} \vect{I}_{d,g,1}\right]
%\label{eq:stage1_intensity}
%\eenum
%\benum
%\vect{T}_{1} = \vect{T}_n + a_{11}\Delta t \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_{g,1} - 4\pi\left[\widehat{\mathbf B}_g^* +   \widehat{\mathbf D}_g^*\left(\vect{T}_1 - \vect{T}^*  \right)\right]   \right \} } \right]
%\label{eq:stage1_temp}
%\eenum
%proceeding as before, and seeking to eliminate $\vect{T}_1$ from \eqt{eq:stage1_intensity} we first must manipulate \eqt{eq:stage1_temp} to isolate $\vect{T}_1$.
%\be
%\vect{T}_1 + a_{11}\Delta t \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{ 4\pi \Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*}  \right]\vect{T}_1 = \vect{T}_n + 
%a_{11}\Delta t \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_{g,1} - 4\pi\left(\widehat{\mathbf B}_g^* - \widehat{\mathbf D}_g^*\vect{T}^*\right) \right \} } \right]
%\ee
%%
%%
%\begin{multline*}
%\left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]\vect{T}_1 = \vect{T}_n + \dots \\
%a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{ \Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_{g,1} - 4\pi \widehat{\mathbf B}_g^*  \right \} } +
%4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* } \right]\vect{T}^*
%\end{multline*}
%%
%%
%\begin{multline*}
%\vect{T}_1 = \left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\vect{T}_n + 
%a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{ \Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_{g,1} - 4\pi \widehat{\mathbf B}_g^*  \right \} }  \right] \dots \\
%+  \left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\mathbf{Z}_{00} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* } \right]  \right]\vect{T}^*
%\end{multline*}
%%
%where $\mathbf{Z}_{00}$ is a zero matrix.
%%
%\begin{multline*}
%\vect{T}_1 = \left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\vect{T}_n + 
%a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{ \Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_{g,1} - 4\pi \widehat{\mathbf B}_g^*  \right \} }  \right] \dots \\
%+  \left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\mathbf{Z}_{00} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* } \right]  \right]\vect{T}^* \dots \\
%+ \left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}\left[\mathbf{I}\vect{T}^* - \mathbf{I}\vect{T}^*  \right]
%\end{multline*}
%%
%Grouping the $\vect{T}^*$ terms, and applying the identity relation:
%%
%\begin{multline}
%\vect{T}_1 = \vect{T}^* + \left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\vect{T}_n -\vect{T}^* + 
%a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{ \Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_{g,1} - 4\pi \widehat{\mathbf B}_g^*  \right \} }  \right]
%\label{eq:mg_T1_iso}
%\end{multline}
%Moving forward and inserting \eqt{eq:mg_T1_iso} into \eqt{eq:stage1_intensity}:
%\begin{multline*}
%\vect{I}_{g,1} = \vect{I}_{n,g} + a_{11} \Delta t c \M^{-1} \left[\frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,1} + \Mw_{\sigma_{a,g}^*}\widehat{\mathbf B}_g^* - \widehat{\mathbf{L}}\vect{I}_{g,1} - \Mw_{\sigma_{t,g}^*}\vect{I}_{g,1} \right] \dots \\
%+ a_{11}\Delta t c \M^{-1} \Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^* 
%\left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\vect{T}_n -\vect{T}^* + 
%a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{ \Mw_{\sigma_{a,g}^*} \left \{ \vect{\phi}_{g,1} - 4\pi \widehat{\mathbf B}_g^*  \right \} }  \right]
%\end{multline*}
%Multiplying by $\frac{1}{a_{11}c\Delta t}\M$, and re-arranging:
%\begin{multline}
%\widehat{\mathbf L} \vect{I}_{g,1} + \left(\frac{1}{a_{11} c \Delta t }\M + \Mw_{\sigma_{t,g}^*}  \right) \vect{I}_{g,1} = \frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,1} \dots \\
%+ a_{11}\Delta t \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[ \mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}\Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \vect{\phi}_{g,1} }\right]   \dots \\
%+ \frac{1}{a_{11} c \Delta t}\M \vect{I}_{n,g} + \Mw_{\sigma_{a,g}^*} \widehat{\mathbf B}_g^* + \dots \\
%\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\vect{T}_n - \vect{T}^* - 4\pi a_{11}\Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf B}_g^*}  \right]
%\label{eq:toolong1}
%\end{multline}
%Multiply the second line of \eqt{eq:toolong1} by the following identity (and shove the $a_{11} \Delta t$ constant back to the $\Mw_{C_v^*}$:
%\be
%\left[4\pi\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*}  \right]^{-1} \left[ 4\pi\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* } \right]
%\ee
%giving
%\small
%\benum
%\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*  
%\left[4\pi\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*}  \right]^{-1} \left[ 4\pi\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* } \right]
%\left[ \mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}\left[a_{11}\Delta t \Mw_{C_v^*}^{-1}\right]\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \vect{\phi}_{g,1} }\right] 
%\label{eq:almost_fission}
%\eenum
%\normalsize
%make the following definitions:
%\begin{subequations}
%\label{eq:mg_stage1_chi_nu}
%\beanum
%\bar{\bar{\chi}}_g &=& \Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^* \left[\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*}  \right]^{-1} \\
%%
%%
%\bar{\bar{\nu}}_1 &=& \left[ 4\pi\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* } \right]
%\left[ \mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}\left[a_{11} \Delta t \Mw_{C_v^*}^{-1}\right]\\
%%
%%
%\overline{\overline{ \Sigma \Phi}}_1& =&  \left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \vect{\phi}_{g,1} }\right] 
%\eeanum
%\end{subequations}
%inserting \eqts{eq:mg_stage1_chi_nu} into \eqt{eq:almost_fission}
%\be
%\frac{1}{4\pi}\bar{\bar{\chi}}_g\bar{\bar{\nu}}_1 \overline{\overline{\Sigma \Phi}}_1
%\ee
%defining more terms for \eqt{eq:toolong1}:
%\begin{subequations}
%\label{eq:stage1_remainder}
%\begin{multline}
%\bar{\bar{\xi}}_{g,1} = \frac{1}{a_{11} c \Delta t}\M \vect{I}_{n,g} + \Mw_{\sigma_{a,g}^*} \widehat{\mathbf B}_g^* + \dots \\
%\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{11} \Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]^{-1}
%\left[\vect{T}_n - \vect{T}^* - 4\pi a_{11}\Delta t \Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf B}_g^*}  \right]
%\end{multline}
%\benum
%\mathbf{M}_{\sigma_t,1} = \frac{1}{a_{11}c\Delta t}\M + \Mw_{\sigma_{t,g}^*}
%\eenum
%\end{subequations}
%we finally arrive at an equation that is very similar to the canonical multigroup fission problem:
%\benum
%\widehat{\mathbf L}\vect{I}_{g,1} + \mathbf{M}_{\sigma_{t},1}\vect{I}_{g,1} = \frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,1} + \frac{1}{4\pi}\bar{\bar{\chi}}_g\bar{\bar{\nu}}\overline{\overline{\Sigma \Phi}}_1 + \bar{\bar{\xi}}_{g,1}
%\label{eq:stage1_complete}
%\eenum
%Though this is unremarkable in and of itself, this is critical for our ability to accelerate the ``fission'' source convergence problem which can be very, very slow to converge.  Having solved \eqt{eq:stage1_complete} for $\vect{I}_{g,1}$, we update the temperature iterate, $\vect{T}_1$ using \eqt{eq:mg_T1_iso}.  At this point, \eqt{eq:stage1_complete} can be solved again using the just found value of $\vect{T}_1$ as the new value of $\vect{T}^*$, or we can move forward with the time integration process.  Regardless of whether we iterate upon $\vect{T}^*$ or not, we apply the definitions of \eqt{eq:multi-group-intensity} and \eqt{eq:multi-group-temperature} to find $k_{I,g,1}$ and $k_{T,1}$.  We use the final value of $\vect{T}_1$ to evaluate all material properties.
%\benum
%k_{I,g,1} = c\M^{-1}\left[\frac{1}{4\pi}\Mw_{\sigma_{s,g,1}}\vect{\phi}_{g,1} + \Mw_{\sigma_{a,g,1}}\widehat{\mathbf B}_{g,1} - \widehat{\mathbf L} \vect{I}_{g,1} - \Mw_{\sigma_{t,g,1}} \vect{I}_{g,1}  \right]
%\eenum
%\benum
%k_{T,1} = \Mw_{C_v,1}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g,1}} \left \{\vect{\phi}_{g,1} - 4\pi\left[\widehat{\mathbf B}_{g,1}  \right]   \right \} }
%\eenum
%where we note that the quantities with a subscript 1, e.g. $x_1$, implies evaluation of $x$ at $\vect{T}_1$.  Note that we have also skipped the linearization of $\widehat{\mathbf B}_g$, implying that we have converged $\vect{T}_1$
%\vspace{0.5in}
%\\
%\emph{ Do we do this when we have not iterated on $\vect{T}^*$ ???}
%\vspace{0.5in}
%
%\subsection{$i$-th RK step}
%Extending now to the $i$-th SDIRK step, we first write the equations for $\vect{I}_{g,i}$ and $\vect{T}_i$.
%\begin{multline}
%\vect{I}_{g,i} = \vect{I}_{g,n} + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{I,g,j}} + \dots \\
%a_{ii}c\Delta t \M^{-1} \left[
%\frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,i} + \Mw_{\sigma_{a,g}^*} \left[\widehat{\mathbf B}_g^* +\widehat{\mathbf D}_g^*\left(\vect{T}_i - \vect{T}^*\right)  \right] - \widehat{\mathbf L}\vect{I}_{g,i} - \Mw_{\sigma_{t,g}^*} \vect{I}_{g,i}  
%\right] 
%\label{eq:mg_intensity_stagei}
%\end{multline}
%\benum
%\vect{T}_i = \vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} + a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left \{ \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\left[\phi_{g,i} - 4\pi \left(\widehat{\mathbf B}_g^* + \widehat{\mathbf D}_g^*\left(\vect{T}_i - \vect{T}^*  \right)\right)  \right] }  \right\}
%\label{eq:mg_temperature_stagei}
%\eenum
%Proceeding as we have before, isolating $\vect{T}_i$ in \eqt{eq:mg_temperature_stagei}:
%\begin{multline*}
%\vect{T}_i + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left[\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right]\vect{T}_i = \dots \\
%\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} + a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left \{ \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\left[\phi_{g,i} - 4\pi \left(\widehat{\mathbf B}_g^* - \widehat{\mathbf D}_g^* \vect{T}^* \right) \right] } \right \}
%\end{multline*}
%%
%%
%\begin{multline*}
%\vect{T}_i = \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1} \left[\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}}\right] \dots \\
%+ \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[a_{ii} \Delta t \Mw_{C_v^*}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\left(\phi_{g,i} - 4\pi \widehat{\mathbf B}_g^* \right)  } \right] \dots \\
%+ \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[4\pi a_{ii}\Delta t\Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}  \widehat{\mathbf D}_g^* }\right] \vect{T}^*
%\end{multline*}
%%
%%
%\begin{multline*}
%\vect{T}_i = \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1} \left[\vect{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}}\right] \dots \\
%+ \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[a_{ii} \Delta t \Mw_{C_v^*}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\left(\phi_{g,i} - 4\pi \widehat{\mathbf B}_g^* \right)  } \right] \dots \\
%+ \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[4\pi a_{ii}\Delta t\Mw_{C_v^*}^{-1}\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}  \widehat{\mathbf D}_g^* }\right] \vect{T}^* \\
%+ \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}\left[\mathbf{I}\vect{T}^* - \mathbf{I}\vect{T}^*  \right]
%\end{multline*}
%%
%%
%\begin{multline}
%\vect{T}_i = \vect{T}^* + \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1} \left[\vect{T}_n - \vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}}\right] \dots \\
%+ \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[a_{ii} \Delta t \Mw_{C_v^*}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\left(\phi_{g,i} - 4\pi \widehat{\mathbf B}_g^* \right)  } \right] 
%\label{eq:mg_Ti_iso}
%\end{multline}
%Inserting \eqt{eq:mg_Ti_iso} into \eqt{eq:mg_intensity_stagei} we have:
%\begin{multline*}
%\vect{I}_{g,i} = \vect{I}_{g,n} + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{I,g,j}} +
%%
%%
%a_{ii}c\Delta t \M^{-1} \left[
%\frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,i} + \Mw_{\sigma_{a,g}^*} \widehat{\mathbf B}_g^* - \widehat{\mathbf L}\vect{I}_{g,i} - \Mw_{\sigma_{t,g}^*} \vect{I}_{g,i} \right] \dots \\
%%
%+ a_{ii}c\Delta t \M^{-1} \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1} \left[\vect{T}_n - \vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}}\right] \dots \\
%%
%%
%+ a_{ii}c\Delta t \M^{-1} \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[a_{ii} \Delta t \Mw_{C_v^*}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\left(\phi_{g,i} - 4\pi \widehat{\mathbf B}_g^* \right)  } \right] 
%\end{multline*}
%%
%%
%Multiplying by $\frac{1}{a_{ii}c \Delta t}\M$
%\begin{multline*}
%\frac{1}{a_{ii}c\Delta t}\M\vect{I}_{g,i} = \frac{1}{a_{ii}c\Delta t}\M \vect{I}_{g,n} + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,g,j}} +
%%
%%
%\left[
%\frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,i} + \Mw_{\sigma_{a,g}^*} \widehat{\mathbf B}_g^* - \widehat{\mathbf L}\vect{I}_{g,i} - \Mw_{\sigma_{t,g}^*} \vect{I}_{g,i} \right] \dots \\
%%
%+  \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1} \left[\vect{T}_n - \vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}}\right] \dots \\
%%
%%
%+ \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[a_{ii} \Delta t \Mw_{C_v^*}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\left(\phi_{g,i} - 4\pi \widehat{\mathbf B}_g^* \right)  } \right] 
%\end{multline*}
%%
%%
%Moving terms around:
%%
%%
%\begin{multline}
%\widehat{\mathbf L} \vect{I}_{g,i} + \left[\frac{1}{ca_{ii}\Delta t}\M + \Mw_{\sigma_{t,g}^*}  \right]\vect{I}_{g,i} = \frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,i} + \dots \\
%%
%%
%+ \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[a_{ii} \Delta t \Mw_{C_v^*}^{-1}\right] \left \{ \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\phi_{g,i}} \right \} \dots \\
%+ 
%\frac{1}{a_{ii}c\Delta t}\M \vect{I}_{g,n} + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,g,j}} + \Mw_{\sigma_{a,g}^*} \widehat{\mathbf B}_g^* \dots \\
%%
%%
%+  \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[ \vect{T}_n - \vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} - 4\pi a_{ii}\Delta t \Mw_{C_v^*}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf B}_g^* } \right]
%\label{eq:mg_stagei_long}
%\end{multline}
%Make the following definitions:
%\begin{subequations}
%\label{eq:mg_stagei_defs}
%%
%\benum
%\M_{\sigma_{t},i} = \frac{1}{ca_{ii}\Delta t}\M + \Mw_{\sigma_{t,g}^*}
%\eenum
%%
%%
%\begin{multline}
%\bar{\bar{\xi}}_{g,i} = \frac{1}{a_{ii}c\Delta t}\M \vect{I}_{g,n} + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,g,j}} + \Mw_{\sigma_{a,g}^*} \widehat{\mathbf B}_g^* \dots \\
%%
%%
%+  \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[ \vect{T}_n - \vect{T}^* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} - 4\pi a_{ii}\Delta t \Mw_{C_v^*}^{-1} \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\widehat{\mathbf B}_g^* } \right]
%\end{multline}
%%
%\end{subequations}
%Inserting into \eqt{eq:mg_stagei_long}:
%\begin{multline}
%\widehat{\mathbf L}\vect{I}_{g,i} + \mathbf{M}_{\sigma_t,i} \vect{I}_{g,i} = \frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,i} + \bar{\bar{\xi}}_{g,i} + \dots \\
%+ \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^*\left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1}
%\left[a_{ii} \Delta t \Mw_{C_v^*}^{-1}\right] \left \{ \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\phi_{g,i}} \right \}
%\label{eq:mg_stagei_partial}
%\end{multline}
%Multiplying the last line by the following equivalent to the identity matrix:
%\be
%\left[4\pi \sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*} \right]^{-1}\left[4\pi \sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*} \right]
%\ee
%we can group terms in the following manner:
%\begin{multline*}
%\frac{1}{4\pi} \left \{ 
%\Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* \left[\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*} \right]^{-1}  \right \} \dots \\
%\left \{
%\left[\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*} \right] \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1} \left[4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}  \right]
%\right \} \dots \\
%\left \{ \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\phi_{g,i}} \right \}
%\end{multline*}
%Make the following pseudo-fission source definitions:
%\begin{subequations}
%\label{eq:mg_stagei_fission_defs}
%\beanum
%\bar{\bar{\chi}}_g &=& \Mw_{\sigma_{a,g}^*}\widehat{\mathbf D}_g^* \left[\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*} \right]^{-1}  \\
%%
%\bar{\bar{\nu}}_i &=& \left[\sum_{g=1}^{G}{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*} \right] \left[\mathbf{I} + 4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}\left\{\sum_{g=1}^G{\Mw_{\sigma_{a,g}^*} \widehat{\mathbf D}_g^*  }\right\}   \right]^{-1} \left[4\pi a_{ii} \Delta t \Mw_{C_v^*}^{-1}  \right] \\
%%
%\overline{\overline{\Sigma \Phi}}_i &=& \sum_{g=1}^G{\Mw_{\sigma_{a,g}^*}\phi_{g,i}}
%\eeanum
%\end{subequations}
%Inserting \eqts{eq:mg_stagei_fission_defs} into \eqt{eq:mg_stagei_partial} we arrive at our final form of the radiation intensity equation:
%\benum
%\widehat{ \mathbf L}\vect{I}_{g,i} + \mathbf{M}_{\sigma_t,i} \vect{I}_{g,i} = \frac{1}{4\pi}\Mw_{\sigma_{s,g}^*}\vect{\phi}_{g,i} + \frac{1}{4\pi}\bar{\bar{\chi}}_g \bar{\bar{\nu}}_i \overline{\overline{\Sigma \Phi}}_i + \bar{\bar{\xi}}_{g,i} 
%\eenum
%Having solved for $\vect{I}_{g,i}$ we then find $\vect{T}_i$ as we did in the first SDIRK step, where again, we can either iterate on $\vect{T}_i$, or simply find $\vect{I}_{g,i}$ once using the material properties associated with the initial guess for $\vect{T}^*$.  Having settled on a $\vect{T}_i$, we evaluate $k_{I,g,i}$ and $k_{T,i}$ using the material properties associated with $\vect{T}_{i}$:
%\benum
%k_{I,g,i} =  c\M^{-1}\left[\frac{1}{4\pi}\Mw_{\sigma_{s,g,i}} \vect{\phi}_{g,i} + \Mw_{\sigma_{a,g,i}}\widehat{\mathbf B}_{g,i} - \widehat{\mathbf L}\vect{I}_{g,i} - \Mw_{\sigma_{t,g,i}}\vect{I}_{g,i} \right]
%\eenum
%\benum
%k_{T,i} = \Mw_{C_v,i}^{-1}\left[ \sum_{g=1}^G{ \Mw_{\sigma_{a,g,i}}\left(\vect{\phi}_{g,i} - 4\pi \widehat{\mathbf B}_{g,i}  \right)} \right]
%\eenum
%After all the stages are solved for, the solution is advanced to time step $n+1$:
%\be
%\vect{I}_{g,n+1} = \vect{I}_n + \Delta t \sum_{i=1}^s{b_i k_{I,g,i}}
%\ee
%\small
%\be
%\vect{T}_{n+1} = \vect{T}_n + \Delta t \sum_{i=1}^s{b_i k_{T,i}}
%\ee
\end{document}